release:
  stage: release
  when: manual
  only:
    refs:
      - tags
  script:
   - env
#    - echo "TAG=v$(cat package.json | jq -r '.version')" >> variables.env
#    - echo "EXTRA_DESCRIPTION=release project $CI_PROJECT_NAME $TAG" >> variables.env
  artifacts:
    reports:
      dotenv: variables.env  # Use artifacts:reports:dotenv to expose the variables to other jobs

release_publish:
  stage: release
  image: registry.gitlab.com/gitlab-org/release-cli:latest
  needs:
    - job: release
      artifacts: true
  only:
    refs:
      - tags
  script:
    - echo "running release for $CI_COMMIT_TAG"
  release:
    name: 'Release $CI_COMMIT_TAG'
    description: '$EXTRA_DESCRIPTION'
    tag_name: '$CI_COMMIT_TAG'
    ref: '$CI_COMMIT_SHA'
#    milestones:
#      - '$TAG'